@model List<KutuphaneMVC.Models.User>
@{
    ViewData["Title"] = "KullanÄ±cÄ± YÃ¶netimi";
}

<h2 class="mb-4 fw-bold text-primary">ğŸ‘¤ KullanÄ±cÄ± YÃ¶netimi</h2>

<div class="mb-3">
    <a asp-action="Create" class="btn btn-success">
        â• Yeni KullanÄ±cÄ± OluÅŸtur
    </a>
</div>

@if (Model.Any())
{
    <div class="table-responsive">
        <table class="table table-hover">
            <thead class="table-dark">
                <tr>
                    <th>KullanÄ±cÄ± AdÄ±</th>
                    <th>Email</th>
                    <th>Rol</th>
                    <th>BaÄŸlÄ± Ãœye</th>
                    <th>Durum</th>
                    <th>KayÄ±t Tarihi</th>
                    <th>Son GiriÅŸ</th>
                    <th>Ä°ÅŸlemler</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model)
                {
                    <tr class="@(user.IsActive ? "" : "table-secondary")">
                        <td>
                            <strong>@user.Username</strong>
                        </td>
                        <td>@user.Email</td>
                        <td>
                            @if (user.Role == KutuphaneMVC.Models.UserRole.Admin)
                            {
                                <span class="badge bg-warning text-dark">ğŸ‘‘ Admin</span>
                            }
                            else
                            {
                                <span class="badge bg-info">ğŸ‘¤ KullanÄ±cÄ±</span>
                            }
                        </td>
                        <td>
                            @if (user.Member != null)
                            {
                                <span>@user.Member.FullName</span>
                            }
                            else
                            {
                                <span class="text-muted">-</span>
                            }
                        </td>
                        <td>
                            @if (user.IsActive)
                            {
                                <span class="badge bg-success">âœ… Aktif</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">âŒ Pasif</span>
                            }
                        </td>
                        <td>@user.CreatedDate.ToShortDateString()</td>
                        <td>
                            @if (user.LastLoginDate.HasValue)
                            {
                                @user.LastLoginDate.Value.ToString("dd.MM.yyyy HH:mm")
                            }
                            else
                            {
                                <span class="text-muted">HiÃ§ giriÅŸ yapmadÄ±</span>
                            }
                        </td>
                        <td>
                            <div class="btn-group-vertical" role="group">
                                <a asp-action="Edit" asp-route-id="@user.UserId" class="btn btn-sm btn-primary mb-1">
                                    âœï¸ DÃ¼zenle
                                </a>
                                <form asp-action="ToggleActive" asp-route-id="@user.UserId" method="post" class="d-inline">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="btn btn-sm @(user.IsActive ? "btn-warning" : "btn-success") w-100"
                                            onclick="return confirm('@(user.IsActive ? "Bu kullanÄ±cÄ±yÄ± pasif yapmak istediÄŸinizden emin misiniz?" : "Bu kullanÄ±cÄ±yÄ± aktif yapmak istediÄŸinizden emin misiniz?")');">
                                        @(user.IsActive ? "â¸ï¸ Pasif Yap" : "â–¶ï¸ Aktif Yap")
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="alert alert-info">
        <strong>ğŸ‘¤ HenÃ¼z kullanÄ±cÄ± bulunmamaktadÄ±r.</strong>
    </div>
}
